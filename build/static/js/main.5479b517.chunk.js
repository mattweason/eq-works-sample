(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{143:function(e,t,a){e.exports=a(293)},148:function(e,t,a){},156:function(e,t,a){},270:function(e,t,a){},272:function(e,t,a){},293:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),s=a(9),l=a.n(s),i=(a(148),a(150),a(152),a(154),a(20)),c=a(14),o=a(30),u=a(28),m=a(31),d=(a(156),a(25)),h=a.n(d),p=a(17),v=a.n(p),f=a(117),k={impressions:"#FF6384",clicks:"#4BC0C0",revenue:"#FFCE56",events:"#E7E9ED"},b=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).chartReference=r.a.createRef(),a.state={data:{datasets:[],labels:[]}},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"callAPI",value:function(){var e=this,t=[],a=[];fetch("http://localhost:5555/stats/daily").then(function(e){return e.text()}).then(function(e){return t=e,fetch("http://localhost:5555/events/daily")}).then(function(e){return e.text()}).then(function(n){a=n,e.packageData(JSON.parse(t),JSON.parse(a))}).catch(function(e){return e})}},{key:"componentDidMount",value:function(){this.callAPI()}},{key:"packageData",value:function(e,t){for(var a=v.a.map(e,function(e){var a=v.a.findWhere(t,{date:e.date});return v.a.extend(e,a)}),n=v.a.pluck(a,"date"),r=0;r<n.length;r++)n[r]=h()(n[r]).format("dddd");for(var s=[],l=Object.keys(a[0]),i=v.a.filter(l,v.a.partial(v.a.contains,this.props.metrics)),c=0;c<i.length;c++){var o={label:i[c],fill:!1,lineTension:.1,backgroundColor:k[i[c]],borderColor:k[i[c]],borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",pointBorderColor:k[i[c]],pointBackgroundColor:"#fff",pointBorderWidth:1,pointHoverRadius:5,pointHoverBackgroundColor:k[i[c]],pointHoverBorderColor:"rgba(220,220,220,1)",pointHoverBorderWidth:2,pointRadius:1,pointHitRadius:10,data:v.a.pluck(a,i[c])};s.push(o)}this.setState({data:{datasets:s,labels:n}})}},{key:"render",value:function(){return r.a.createElement(f.a,{ref:this.chartReference,data:this.state.data})}}]),t}(r.a.Component),g=a(119),E=a.n(g),y=a(120),C=(a(270),function(e){var t=e.size,a=e.color,n=e.metricValue,s=e.metricProp;return r.a.createElement("div",{className:"map-circle",style:{backgroundColor:"rgba("+a+",0.5)",width:t+"px",height:t+"px",borderRadius:t/2+"px",border:"1px solid rgb("+a+")"}},r.a.createElement("div",{className:"value",style:{left:t+"px",top:t/2-10+"px"}},s,": ",n))}),M=a(323),O=a(324),D=a(327),S=a(125),j=a(52),x=a(325),B=(a(272),["impressions","clicks","revenue"]),N=["255,0,0","0,255,0","0,0,255"],R={},w="",I="",P="",A="",z=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCheckbox=function(e){return function(t){var n=JSON.parse(JSON.stringify(a.state.metricsBool));n[e]=t.target.checked,a.setState({metricsBool:n},function(){"events"===e&&a.renderEventMarkers()})}},a.handleDateChange=function(e){a.setState({selectedDate:e},function(){w=a.filterMetrics(),a.renderEventMarkers(),a.packageMetrics()})},a.state={metrics:"",mapCircleElements:"",metricsBool:{impressions:!1,clicks:!1,revenue:!1,events:!0},dateRange:"",selectedDate:""},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=document.createElement("script");t.src="https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/markerclusterer.js",t.async=!0,document.body.appendChild(t),this.setState({dateRange:v.a.uniq(v.a.pluck(this.props.data,"date"))},function(){e.setState({selectedDate:e.state.dateRange[0]},function(){w=e.filterMetrics(),e.packageMetrics()})})}},{key:"handleApiLoaded",value:function(e,t){I=t,P=e,this.renderEventMarkers()}},{key:"renderEventMarkers",value:function(){if(A&&A.clearMarkers(),this.state.metricsBool.events){var e=this.getEventMarkers(),t=e&&e.map(function(e){return new I.Marker({position:e})});A=new y.a(P,t,{imagePath:"https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m",gridSize:10,minimumClusterSize:2})}}},{key:"getEventMarkers",value:function(){for(var e=[],t=0;t<w.length;t++)for(var a=w[t],n=0;n<a.events;n++)e.push({lat:a.lat,lng:a.lng});return e}},{key:"filterMetrics",value:function(){var e=h()(this.state.selectedDate);return v.a.filter(this.props.data,function(t){return h()(t.date,"ll").isSame(e,"day")})}},{key:"packageMetrics",value:function(){for(var e={},t=0;t<w.length;t++){var a=w[t];if(e.hasOwnProperty(a.name))for(var n=0;n<B.length;n++)e[a.name][B[n]]+=a[B[n]];else{e[a.name]={lat:a.lat,lng:a.lng};for(var r=0;r<B.length;r++)e[a.name][B[r]]=a[B[r]]}}this.bundleMapCircleElements(e)}},{key:"bundleMapCircleElements",value:function(e){this.calculateMetricRatios(e);for(var t={},a=0;a<B.length;a++)t[B[a]]=[];for(var n in e)for(var s=e[n],l=0;l<B.length;l++)t[B[l]].push(r.a.createElement(C,{metricProp:B[l],metricValue:s[B[l]],key:n,lat:s.lat,lng:s.lng,color:N[l],size:this.calculateCircleSize(s[B[l]],B[l])}));this.setState({mapCircleElements:t})}},{key:"calculateMetricRatios",value:function(e){for(var t=0;t<B.length;t++){var a=v.a.max(v.a.pluck(e,B[t]));R[B[t]]=a/(Math.PI*Math.pow(100,2))}}},{key:"calculateCircleSize",value:function(e,t){return 2*Math.sqrt(e/(Math.PI*R[t]))}},{key:"renderMapCircles",value:function(e){return this.state.mapCircleElements[e]}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"flex-row"},r.a.createElement("div",{className:"map-wrapper"},r.a.createElement(E.a,{bootstrapURLKeys:{key:"AIzaSyAIWKGtCqVn94mx_Kpw9jIR97nJB15xvgM"},yesIWantToUseGoogleMapApiInternals:!0,onGoogleApiLoaded:function(t){var a=t.map,n=t.maps;return e.handleApiLoaded(a,n)},defaultCenter:this.props.center,defaultZoom:this.props.zoom,options:this.props.otherOptions},this.state.metricsBool.impressions?this.renderMapCircles("impressions"):null,this.state.metricsBool.clicks?this.renderMapCircles("clicks"):null,this.state.metricsBool.revenue?this.renderMapCircles("revenue"):null)),r.a.createElement("div",{className:"checkbox-wrapper"},this.state.selectedDate?r.a.createElement(j.a,{utils:S.a},r.a.createElement(x.a,{disableToolbar:!0,variant:"inline",format:"MM/dd/yyyy",minDate:this.state.dateRange[0],maxDate:this.state.dateRange[this.state.dateRange.length-1],margin:"normal",id:"date-picker-inline",label:"Date picker inline",value:h()(this.state.selectedDate),onChange:this.handleDateChange,KeyboardButtonProps:{"aria-label":"change date"}})):null,r.a.createElement(M.a,{row:!0},r.a.createElement(O.a,{control:r.a.createElement(D.a,{checked:this.state.metricsBool.impressions,onChange:this.handleCheckbox("impressions"),value:"impressions"}),label:"Impressions"}),r.a.createElement(O.a,{control:r.a.createElement(D.a,{checked:this.state.metricsBool.clicks,onChange:this.handleCheckbox("clicks"),value:"clicks"}),label:"Clicks"}),r.a.createElement(O.a,{control:r.a.createElement(D.a,{checked:this.state.metricsBool.revenue,onChange:this.handleCheckbox("revenue"),value:"revenue"}),label:"Revenue"}),r.a.createElement(O.a,{control:r.a.createElement(D.a,{checked:this.state.metricsBool.events,onChange:this.handleCheckbox("events"),value:"events"}),label:"Walk-In Events"}))))}}]),t}(r.a.Component);z.defaultProps={center:{lat:43.369765,lng:-79.424882},zoom:9,otherOptions:{minZoom:5,maxZoom:16}};var J=z,W=a(126),H=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).state={tableData:{columns:[],rows:[]}},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.packageData(this.props.data)}},{key:"packageData",value:function(e){for(var t=[],a=Object.keys(e[0]),n=0;n<a.length;n++)t.push({label:a[n].toUpperCase(),field:a[n],sort:"asc"});for(var r=0;r<e.length;r++)e[r].date=h()(e[r].date).format("ll");this.setState({tableData:{columns:t,rows:e}})}},{key:"render",value:function(){return r.a.createElement(W.c,{striped:!0,bordered:!0,small:!0,data:this.state.tableData})}}]),t}(r.a.Component),F=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).state={poiStatsDaily:""},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"callAPI",value:function(){var e=this;fetch("http://localhost:5555/poi-stats/daily").then(function(e){return e.text()}).then(function(t){e.setState({poiStatsDaily:JSON.parse(t)})}).catch(function(e){return e})}},{key:"componentDidMount",value:function(){this.callAPI()}},{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement("div",{className:"card"},r.a.createElement("h2",null,"Impressions/Clicks vs Revenue/Walk-in Events"),r.a.createElement("p",null,"Click on a metric in the legend to toggle it on and off."),r.a.createElement("div",{className:"chart-container"},r.a.createElement("div",{className:"line-chart"},r.a.createElement(b,{metrics:["impressions","clicks"]})),r.a.createElement("div",{className:"line-chart"},r.a.createElement(b,{metrics:["revenue","events"]})))),r.a.createElement("div",{className:"card"},r.a.createElement("h2",null,"POI Map"),r.a.createElement("div",{className:"card-content"},r.a.createElement("div",{className:"map-frame"},this.state.poiStatsDaily?r.a.createElement(J,{data:this.state.poiStatsDaily}):null))),r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"table-frame"},r.a.createElement("h2",null,"POI Stats by Day"),r.a.createElement("div",{className:"card-content"},this.state.poiStatsDaily?r.a.createElement(H,{data:this.state.poiStatsDaily}):null))))}}]),t}(r.a.Component);l.a.render(r.a.createElement(F,null),document.getElementById("root"))}},[[143,2,1]]]);
//# sourceMappingURL=main.5479b517.chunk.js.map